<template>
  <el-tooltip :content="hoverText" placement="top">
    <el-select
      v-model="value"
      :multiple="true"
      collapse-tags
      placeholder="ËØ∑ÈÄâÊã©"
      :filterable="true"
      :clearable="true"
      size="small"
      @change="changeVal"
      @visible-change="handleSelect"
    >
      <el-option-group
        v-for="group in options"
        :key="group.label"
        :label="group.label"
      >
        <el-option
          v-for="item in group.options"
          :key="item.value"
          :value="item.value"
        >
        </el-option>
      </el-option-group>
    </el-select>
  </el-tooltip>
</template>

<script>
import { mapGetters } from 'vuex'
export default {
  data() {
    return {
      options: [
        {
          options: [
            {
              value: 'ÊàëÂÖ®ÈÉΩË¶Å'
            }
          ]
        },
        {
          label: 'ÁÉ≠Èó®Â≤ó‰Ωç',
          options: [
            {
              value: 'ÂêéÁ´ØÂºÄÂèë'
            },
            {
              value: 'ÊµãËØï'
            },
            {
              value: '‰∫∫Â∑•Êô∫ËÉΩ'
            }
          ]
        },
        {
          label: 'Â≤ó‰ΩçÂêç',
          options: [
            {
              value: 'ÁßªÂä®ÂâçÁ´ØÂºÄÂèë'
            },
            {
              value: 'ËøêÁª¥'
            },
            {
              value: 'Êï∞ÊçÆÂºÄÂèë'
            },
            {
              value: 'ÂâçÁ´ØÂºÄÂèë'
            },
            {
              value: 'È´òÁ´ØÊäÄÊúØËÅå‰Ωç'
            },
            {
              value: 'È°πÁõÆÁÆ°ÁêÜ'
            },
            {
              value: 'Á°¨‰ª∂ÂºÄÂèë'
            },
            {
              value: '‰ºÅ‰∏öËΩØ‰ª∂'
            },
            {
              value: '‰∫ßÂìÅÁªèÁêÜ'
            },
            {
              value: 'ËøêËê•'
            }
          ]
        }
      ],
      value: [
        'ÊàëÂÖ®ÈÉΩË¶Å',
        'ÂêéÁ´ØÂºÄÂèë',
        'ÊµãËØï',
        '‰∫∫Â∑•Êô∫ËÉΩ',
        'ÁßªÂä®ÂâçÁ´ØÂºÄÂèë',
        'ËøêÁª¥',
        'Êï∞ÊçÆÂºÄÂèë',
        'ÂâçÁ´ØÂºÄÂèë',
        'È´òÁ´ØÊäÄÊúØËÅå‰Ωç',
        'È°πÁõÆÁÆ°ÁêÜ',
        'Á°¨‰ª∂ÂºÄÂèë',
        '‰ºÅ‰∏öËΩØ‰ª∂',
        '‰∫ßÂìÅÁªèÁêÜ',
        'ËøêËê•'
      ],
      oldValue: [
        'ÊàëÂÖ®ÈÉΩË¶Å',
        'ÂêéÁ´ØÂºÄÂèë',
        'ÊµãËØï',
        '‰∫∫Â∑•Êô∫ËÉΩ',
        'ÁßªÂä®ÂâçÁ´ØÂºÄÂèë',
        'ËøêÁª¥',
        'Êï∞ÊçÆÂºÄÂèë',
        'ÂâçÁ´ØÂºÄÂèë',
        'È´òÁ´ØÊäÄÊúØËÅå‰Ωç',
        'È°πÁõÆÁÆ°ÁêÜ',
        'Á°¨‰ª∂ÂºÄÂèë',
        '‰ºÅ‰∏öËΩØ‰ª∂',
        '‰∫ßÂìÅÁªèÁêÜ',
        'ËøêËê•'
      ],
      hoverText:
        'ÂêéÁ´ØÂºÄÂèë„ÄÅÊµãËØï„ÄÅ‰∫∫Â∑•Êô∫ËÉΩ„ÄÅÁßªÂä®ÂâçÁ´ØÂºÄÂèë„ÄÅËøêÁª¥„ÄÅÊï∞ÊçÆÂºÄÂèë„ÄÅÂâçÁ´ØÂºÄÂèë„ÄÅÈ´òÁ´ØÊäÄÊúØËÅå‰Ωç„ÄÅÈ°πÁõÆÁÆ°ÁêÜ„ÄÅÁ°¨‰ª∂ÂºÄÂèë„ÄÅ‰ºÅ‰∏öËΩØ‰ª∂„ÄÅ‰∫ßÂìÅÁªèÁêÜ„ÄÅËøêËê•'
    }
  },
  computed: {
    ...mapGetters(['tableForm', 'watchForm'])
  },
  watch: {
    watchForm: {
      handler() {
        this.value = this.tableForm.position
        this.oldValue = this.tableForm.position
      }
    }
  },
  methods: {
    changeVal(val) {
      const allKey = [
        'ÊàëÂÖ®ÈÉΩË¶Å',
        'ÂêéÁ´ØÂºÄÂèë',
        'ÊµãËØï',
        '‰∫∫Â∑•Êô∫ËÉΩ',
        'ÁßªÂä®ÂâçÁ´ØÂºÄÂèë',
        'ËøêÁª¥',
        'Êï∞ÊçÆÂºÄÂèë',
        'ÂâçÁ´ØÂºÄÂèë',
        'È´òÁ´ØÊäÄÊúØËÅå‰Ωç',
        'È°πÁõÆÁÆ°ÁêÜ',
        'Á°¨‰ª∂ÂºÄÂèë',
        '‰ºÅ‰∏öËΩØ‰ª∂',
        '‰∫ßÂìÅÁªèÁêÜ',
        'ËøêËê•'
      ]
      const nowFlag = val.some((item) => {
        return item === 'ÊàëÂÖ®ÈÉΩË¶Å'
      }) // ÂΩìÂâçÊòØÂê¶ÂåÖÂê´ ÂÖ®ÈÄâ
      const oldFlag = this.oldValue.some((item) => {
        return item === 'ÊàëÂÖ®ÈÉΩË¶Å'
      }) // ‰∏ä‰∏ÄÊ¨°ÊòØÂê¶ÂåÖÂê´ ÂÖ®ÈÄâ
      /**
       * Â£∞Êòé oldValueÊù•Â≠òÂÇ®‰∏ä‰∏ÄÊ¨°ÁöÑÂÄº„ÄÇÁî®Êù•ÊØîËæÉ‰∏é‰∏ä‰∏ÄÊ¨°ÁöÑÂèòÂåñÔºåÊù•Âà§Êñ≠ÁÇπÂáªÁöÑÈÄâÈ°πÊòØÂê¶ÊòØÂÖ®ÈÄâ
       * ÂΩìÂâçÊúâÂÖ®ÈÄâÔºå‰∏ä‰∏ÄÊ¨°ÊúâÂÖ®ÈÄâ„ÄÇËØ¥ÊòéÊ≠§Ê¨°ÁÇπÂáªÁöÑÊòØÂÖ∂‰ªñÈÄâÈ°πÔºåÂç≥Ê≠§Ê¨°ËÆæÁΩÆÂèñÊ∂àÂÖ®ÈÄâÔºåÁÇπÂáªÁöÑÈÄâÈ°π "Ëá™ÈÄÇÂ∫î"
       * ÂΩìÂâçÊúâÂÖ®ÈÄâÔºå‰∏ä‰∏ÄÊ¨°Ê≤°ÊúâÂÖ®ÈÄâ„ÄÇËØ¥ÊòéÁÇπÂáªÁöÑÊòØÂÖ®ÈÄâÔºåÂç≥Ê≠§Ê¨°ËÆæÁΩÆÂÖ®ÈÄâ
       * ÂΩìÂâçÊ≤°ÂÖ®ÈÄâÔºå‰∏ä‰∏ÄÊ¨°ÊúâÂÖ®ÈÄâ„ÄÇËØ¥ÊòéÊ≠§Ê¨°ÁÇπÂáªÁöÑÊòØÂÖ®ÈÄâÔºåÂç≥Ê≠§Ê¨°ËÆæÁΩÆÂÖ®ÈÉ®‰∏çÈÄâ
       * ÂΩìÂâçÊ≤°ÊúâÂÖ®ÈÄâÔºå‰∏ä‰∏ÄÊ¨°Ê≤°ÊúâÂÖ®ÈÄâ„ÄÇÂ¶ÇÂΩìÂâç val.length === 13ÔºåÊ≠§Ê¨°ËÆæÁΩÆÂÖ®ÈÄâ„ÄÇÂê¶ÂàôÁÇπÂáªÁöÑÈÄâÈ°π "Ëá™ÈÄÇÂ∫î"
       */
      // ‰ºòÂåñÂâç
      // if (nowFlag && !oldFlag) {
      //   this.value = allKey
      // }
      // if (nowFlag && oldFlag) {
      //   this.value.splice(0, 1)
      // }
      // if (!nowFlag && oldFlag) {
      //   this.value = []
      // }
      // if (!nowFlag && !oldFlag) {
      //   if (val.length === 13) {
      //     this.value = allKey
      //   }
      // }
      /**
       * üí©‰∏ÄËà¨ÁöÑ‰ª£Á†Å
       * ‰ºòÂåñÊñπÊ≥ïÂèÇËÄÉ location-checkbox.vue
       */
      nowFlag && oldFlag && this.value.splice(0, 1)
      nowFlag && !oldFlag && (this.value = allKey)
      !nowFlag && oldFlag && (this.value = [])
      !nowFlag && !oldFlag && val.length === 13 && (this.value = allKey)
      this.oldValue = this.value

      let text = ''
      this.value.forEach((element) => {
        element !== 'ÊàëÂÖ®ÈÉΩË¶Å' && (text += element + '„ÄÅ')
      })
      this.hoverText = text.substring(0, text.length - 1)

      this.$store.dispatch('tableForm', {
        position: this.value
      })
      // if (nowFlag) {
      //   if (oldFlag) {
      //     this.value.splice(0, 1)
      //   } else {
      //     this.value = allKey
      //   }
      // } else {
      //   if (oldFlag) {
      //     this.value = []
      //   } else {
      //     if (val.length === 13) {
      //       this.value = allKey
      //     }
      //   }
      // }
      // this.oldValue = this.value
    },
    handleSelect(flag) {
      // console.log(this.value)
      // console.log(flag)
    }
  }
}
</script>

<style></style>
